---
layout: ""
page_title: "security_policy (Resource)"
description: |-
security_policy resource allows defining security policies.
---

# security_policy (Resource)

The Satori Security Policy is a re-usable object that can be configured to contain multiple sets of dynamic masking configurations and data filtering configurations.
A Security Policy can be applied to on one or more datasets.

The **security_policy** resource allows defining security policies.

## Example Usage

```terraform
resource "satori_security_policy" "security_policy" {
  name = "security policy terraform"
  profile {
    masking {
      active = true
      rule {
        id = "3"
        description = "rule 1"
        active = true
        criteria {
          condition = "IS"
          identity {
            type = "USER"
            name = "test-user"
          }
        }
        action {
          type = "APPLY_MASKING_PROFILE" # optional
          masking_profile_id = satori_masking_profile.masking_profile.id # as reference of previously created masking profile
        }
      }
      rule {
        id = "1"
        description = "rule 2"
        active = true
        criteria {
          condition = "IS_NOT"
          identity {
            type = "IDP_GROUP"
            name = "test-group"
          }
        }
        action {
          type = "APPLY_MASKING_PROFILE"
          masking_profile_id = satori_masking_profile.masking_profile.id
        }
      }
      rule {
        id = "2"
        description = "rule 3"
        active = true
        criteria {
          condition = "IS_NOT"
          identity {
            type = "GROUP"
            group_id = satori_directory_group.group2.id
          }
        }
        action {
          type = "APPLY_MASKING_PROFILE"
          masking_profile_id = satori_masking_profile.masking_profile.id
        }
      }
      rule {
        id = "4"
        description = "rule 4"
        active = true
        criteria {
          condition = "IS_NOT"
          identity {
            type = "GROUP"
            group_id = satori_directory_group.group3.id
          }
        }
        action {
          masking_profile_id = satori_masking_profile.masking_profile.id
        }
      }
    }
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- **name** (String) Security policy name.
- **profile** (Block List, Min: 1, Max: 1) Security policy profile. (see [below for nested schema](#nestedblock--profile))

### Optional

- **id** (String) The ID of this resource.

<a id="nestedblock--profile"></a>
### Nested Schema for `profile`

Optional:

- **masking** (Block List, Max: 1) Masking profile. (see [below for nested schema](#nestedblock--profile--masking))

<a id="nestedblock--profile--masking"></a>
### Nested Schema for `profile.masking`

Required:

- **active** (Boolean) Is active.
- **rule** (Block List, Min: 1) Masking Rule. (see [below for nested schema](#nestedblock--profile--masking--rule))

<a id="nestedblock--profile--masking--rule"></a>
### Nested Schema for `profile.masking.rule`

Required:

- **action** (Block List, Min: 1, Max: 1) Rule action. (see [below for nested schema](#nestedblock--profile--masking--rule--action))
- **active** (Boolean) Is active rule.
- **criteria** (Block List, Min: 1, Max: 1) Masking criteria. (see [below for nested schema](#nestedblock--profile--masking--rule--criteria))
- **description** (String) Rule description.
- **id** (String) Rule id, has to be unique.

<a id="nestedblock--profile--masking--rule--action"></a>
### Nested Schema for `profile.masking.rule.id`

Required:

- **masking_profile_id** (String) The reference id to be applied as masking profile.

Optional:

- **type** (String) Rule type. Defaults to `APPLY_MASKING_PROFILE`.


<a id="nestedblock--profile--masking--rule--criteria"></a>
### Nested Schema for `profile.masking.rule.id`

Required:

- **condition** (String) Identity condition, for example IS_NOT, IS, etc.
- **identity** (Block List, Min: 1, Max: 1) Identity to apply the rule for. (see [below for nested schema](#nestedblock--profile--masking--rule--id--identity))

<a id="nestedblock--profile--masking--rule--id--identity"></a>
### Nested Schema for `profile.masking.rule.id.identity`

Required:

- **type** (String) Identity type, valid types are: USER, IDP_GROUP, GROUP, EVERYONE.
Can not be changed after creation.

Optional:

- **group_id** (String) Directory group ID for identity of type GROUP.
Can not be changed after creation.
- **name** (String) User/group name for identity types of USER and IDP_GROUP.
Can not be changed after creation.